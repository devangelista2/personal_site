<!DOCTYPE html>
<html lang="en"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v9.1.6 <https://hydejack.com/>
-->







<head>
  




  <meta name="robots" content="noindex">



  
    
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Why PCA is not sufficient? | Davide Evangelista</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Why PCA is not sufficient?" />
<meta name="author" content="Davide Evangelista" />
<meta property="og:locale" content="en" />
<meta name="description" content="Clustering introduction with Linear Discriminant Analysis (LDA)" />
<meta property="og:description" content="Clustering introduction with Linear Discriminant Analysis (LDA)" />
<link rel="canonical" href="http://localhost:4000/teaching/2022-09-27-LDA/" />
<meta property="og:url" content="http://localhost:4000/teaching/2022-09-27-LDA/" />
<meta property="og:site_name" content="Davide Evangelista" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-27T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Why PCA is not sufficient?" />
<meta name="twitter:site" content="@DavideEvangel17" />
<meta name="twitter:creator" content="@DavideEvangel17" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Davide Evangelista"},"dateModified":"2022-09-28T13:36:17+02:00","datePublished":"2022-09-27T00:00:00+02:00","description":"Clustering introduction with Linear Discriminant Analysis (LDA)","headline":"Why PCA is not sufficient?","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/teaching/2022-09-27-LDA/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/blog/logo.png"},"name":"Davide Evangelista"},"url":"http://localhost:4000/teaching/2022-09-27-LDA/"}</script>
<!-- End Jekyll SEO tag -->


  

  



  <meta name="theme-color" content="rgb(37,150,190)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Davide Evangelista">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="Davide Evangelista">

<meta name="generator" content="Hydejack v9.1.6" />


<link rel="alternate" href="http://localhost:4000/teaching/2022-09-27-LDA/" hreflang="en">

<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Davide Evangelista" />


<link rel="shortcut icon"    href="/assets/img/blog/logo.ico">
<link rel="apple-touch-icon" href="/assets/img/blog/logo.ico">

<link rel="manifest" href="/assets/site.webmanifest">

<link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com">



<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">






<script>!function(r,c){"use strict";function a(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=c.createElement("script"),e=(n.src=e,t&&a(n,"load",t,{once:!0}),c.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=c.createElement("script");function o(){r._loaded=!0,t&&a(n,"load",t,{once:!0});var e=c.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():a(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){a(c.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}}(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = false;
  w._noToc = false;
  w._noSearch = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2022-09-28T17:45:24+02:00',
  };
  w._clapButton = true;
}(window);</script>


<script async src="/assets/bower_components/MathJax/es5/tex-mml-chtml.js" id="_MathJax"></script>


<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.1.6.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700%7CNoto+Sans:400,400i,700,700i&display=swap" id="_fontsPreload">



  <style id="_pageStyle">

html{--accent-color: rgb(79,177,186);--accent-color-faded: rgba(79,177,186,0.5);--accent-color-highlight: rgba(79,177,186,0.1);--accent-color-darkened: #409ba3;--theme-color: rgb(37,150,190)}

</style>


<!--<![endif]-->




</head>

<body class="no-break-layout">
  


<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-post"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/teaching/">teaching</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>2022-09-27-LDA</span>
        
      </li>
    
  
</ul></nav>
  










<article id="post-teaching-LDA" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        Why PCA is not sufficient?
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2022-09-27T00:00:00+02:00">27 Sep 2022</time> in <a href="/teaching/" class="flip-title">Teaching</a> 
      </span>
      
    </div>

    
    

    



  
    <p class="note-sm" >
      Clustering introduction with Linear Discriminant Analysis (LDA)

    </p>
  


  </header>

  
    <p>Since PCA is an unsupervised learning technique, the lack of informations due to the fact that it is not using the associated label reduce its ability on observing clusters. Consequently it can be defined Linear Discriminant Analysis (LDA), a supervised version of PCA, whose ability on generating clusters is way higher.</p>

<h2 id="setup-for-lda-implementation">Setup for LDA implementation</h2>
<p>The main difference between PCA and LDA is the the latter center the dataset by shifting each column by the centroid of each class, instead of using a global centroid of the data. For simplicity, assume we have a dataset</p>

\[X = [x^1 x^2 \dots x^N] \in \mathbb{R}^{d \times N}\]

<p>and an associated label vector</p>

\[Y = [y^1 y^2 \dots y^N]\]

<p>such that \(y^i\) represents the correct class of \(x^i\). Assume that in our problem there are \(K\) classes \(C_1, \dots, C_K\) and define \(I_k = [i_1, \dots, i_{N_k}]\) as the vector of the indices corresponding to the columns of $X$ associated with the class \(k\) (\(N_k\) is the number of elements lying in the class $k$). To simplify the discussion, assume that our dataset is ordered as</p>

\[X = [X_1 X_2 \dots X_K]\]

<p>where \(X_k\) contains each datapoint such that the corresponding class is \(k\). Now, for each class \(k = 1, \dots, K\) define the class centroid</p>

\[c_k(X) = \frac{1}{N_k} \sum_{i \in I_k} x^i\]

<p>and the global centroid</p>

\[c(X) = \frac{1}{N} \sum_{i=1}^N x^i\]

<p>For any \(k = 1, \dots, K\), define the centered matrix for each class</p>

\[X_{k, c} = X_k - c_k(X_k)\]

<p>and, by joining \(X_{k, c}\) together for any \(k\), we get</p>

\[X_w = [X_{1, c} X_{2, c} \dots X_{K, c}]\]

<p>From \(X_w\), we can define the <strong>within-cluster scatter matrix</strong></p>

\[S_w = X_w X_w^T\]

<p>representing the <em>correlation matrix</em> for points inside of each cluster.</p>

<p>Consequently, define</p>

\[\bar{X}_k = [c_k c_k c_k \dots c_k] \in \mathbb{R}^{d \times N}\]

\[\bar{X} = [\bar{X}_1 \bar{X}_2 \dots \bar{X}_K]\]

<p>and its centered version</p>

\[\bar{X}_c = \bar{X} - c(X)\]

<p>Finally, we define the <strong>between clusters scattering matrix</strong></p>

\[S_b = \bar{X}_c \bar{X}_c^T\]

<p>This concludes the setup part.</p>

<h2 id="idea-and-implementation">Idea and Implementation</h2>
<p>Given the two matrices \(S_w\) and \(S_b\) defined above, we observe that \(S_w\) is symmetrical, since \(S_w^T = (X_w X_w^T)^T = X_w X_w^T = S_w\). If \(S_w\) is also positive definite, you studied that we can compute the Cholesky decomposition of it, i.e. we can decompose</p>

\[S_w = L^T L\]

<p>where \(L \in \mathbb{R}^{d \times d}\) is a lower-triangular matrix.</p>

<p>If \(S_w\) is not positive definite, we can make it positive definite by doing</p>

\[S_w = S_w + \epsilon I\]

<p>where $\epsilon \approx 10^{-6}$ is a small value. A matrix like that will always be positive definite.</p>

<p>Now, given a number \(k\) (representing the dimension on which we want to project), compute the matrix \(W \in \mathbb{R}^{d \times k}\), whose column are the first $k$ eigenvectors of \(L^{-T}S_bL^T\).</p>

<p>Finally, if</p>

\[Q = L^{-1} W\]

<p>then \(Q^T \in \mathbb{R}^{k \times d}\) will be the projection matrix of LDA.</p>

<h2 id="implementation">Implementation</h2>
<p>The implementation simply follows what we just described.</p>

<ul>
  <li>Given the input data \(X\) and the labels \(Y\);</li>
  <li>Compute \(S_w\) and \(S_b\) as described above;</li>
  <li>If possible, compute the Cholesky decomposition of \(S_w = L^T L\), if not, compute the Cholesky decomposition of \(S_w + \epsilon I = L^T L\);</li>
  <li>Find the first \(k\) eigenvectors of \(L^{-T}S_bL^T\) and collect them in a matrix \(W\);</li>
  <li>Compute \(Q = L^{-1} W\) and \(Q^T\).</li>
  <li>Since \(Q^T\) is the projection matrix, we can project \(X\) into \(Z\) as \(Z = Q^T X\).</li>
</ul>

  
</article>



  <hr class="dingbat related mb6" />






  
     


  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img
  
    src="https://www.unibo.it/uniboweb/utils/UserImage.aspx?IdAnagrafica=923305&IdFoto=c2e9b60e"
    srcset="https://via.placeholder.com/128x128 1x,https://via.placeholder.com/256x256 2x"
    
  
  alt="Davide Evangelista"
  class="avatar"
  
  width="120"
  height="120"
  loading="lazy"
/>

  

  
  
  <h2  class="page-title hr-bottom">
    About
  </h2>

  <p>I’m a Mathematics PhD student from University of Bologna. My research interests are Machine Learning 
and Neural Networks, mainly applied to the solution of ill-conditioned Inverse Problems. Sometimes I teach.</p>


  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://twitter.com/DavideEvangel17" title="Twitter" class="no-mark-external">
      <span class="icon-twitter"></span>
      <span class="sr-only">Twitter</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/devangelista2" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:davide.evangelista5@unibo.it" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>


  

  
  

  
    


  <aside class="related mb4" role="complementary">  <h2 class="hr-bottom">Related Posts</h2>  <ul class="related-posts">                  <li class="h4">  <a href="/teaching/2022-09-26-short_introduction_to_ML/" class="flip-title"><span>A (very short) introduction to Machine Learning</span></a>  <time class="faded fine" datetime="2022-09-26T00:00:00+02:00">26 Sep 2022</time></li>                        <li class="h4">  <a href="/research/2022-09-26-short_introduction_to_ML/" class="flip-title"><span>A (very short) introduction to Machine Learning</span></a>  <time class="faded fine" datetime="2022-09-26T00:00:00+02:00">26 Sep 2022</time></li>                        <li class="h4">  <a href="/teaching/2022-09-25-PCA/" class="flip-title"><span>Dimensionality Reduction</span></a>  <time class="faded fine" datetime="2022-09-25T00:00:00+02:00">25 Sep 2022</time></li>            </ul></aside>

  

  
  

  
    

  


  
<footer class="content" role="contentinfo">
  <hr/>
  
    <p><small class="copyright">© 2021. All rights reserved.
</small></p>
  
  
    <nav class="legal"><small>
    
      
      <a class="heading flip-title" href="/LICENSE/">LICENSE</a>
      |
    
      
      <a class="heading flip-title" href="/NOTICE/">NOTICE</a>
      |
    
      
      <a class="heading flip-title" href="/CHANGELOG/">CHANGELOG</a>
      
    
    </small></nav>
  
    <p><small>Powered by <a class="external" href="https://hydejack.com/">Hydejack</a> v<span id="_version">9.1.6</span></small></p>
  <hr class="sr-only"/>
</footer>


</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg sidebar-overlay" style="background-color:rgb(37,150,190);background-image:url(/assets/img/blog/futuristic-networking-technology.jpeg)"></div>

    <div class="sidebar-sticky">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="/assets/img/blog/logo.png" class="avatar" alt="Davide Evangelista" width="120" height="120" loading="lazy" />
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h1">Davide Evangelista</h2></a>
    
    
      <p class="">
        Machine Learning and Neural Networks

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/research/"
          class="sidebar-nav-item "
          
        >
          Research
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/teaching/"
          class="sidebar-nav-item "
          
        >
          Teaching
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/cv/"
          class="sidebar-nav-item "
          
        >
          CV
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/docs/"
          class="sidebar-nav-item "
          
        >
          Documentation
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/about/"
          class="sidebar-nav-item "
          
        >
          About
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://twitter.com/DavideEvangel17" title="Twitter" class="no-mark-external">
      <span class="icon-twitter"></span>
      <span class="sr-only">Twitter</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/devangelista2" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:davide.evangelista5@unibo.it" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>!function(){var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())}();
</script>
  <script src="/assets/js/hydejack-9.1.6.js" type="module"></script>
  <script src="/assets/js/LEGACY-hydejack-9.1.6.js" nomodule defer></script>
  

  

<!--<![endif]-->
  <!-- <script>
  document.querySelector('hy-push-state').setAttribute('prefetch', '');

  document.querySelectorAll('.sidebar a[href^="/"]').forEach(function (el) { 
    el.addEventListener('click', function (e) {
      if (el.pathname === window.location.pathname) {
        e.preventDefault();
        e.stopPropagation();
        document.querySelector('hy-drawer').close();
      }
    });
  });
</script> -->

<!--
Code for integrating CloudFlare's email protection with Hydejack's single page app loading.
-->
<script>
  document.getElementById('_pushState').addEventListener('hy-push-state-after', function (e) {
    function e(e){
      (console.error?console.error:console.log).call(console,e)
    }

    function t(e){
      return l.innerHTML='<a href="'+e.replace(/"/g,"&quot;")+'"></a>',l.childNodes[0].getAttribute("href")
    }

    function r(e,t){
      var r=e.substr(t,2);return parseInt(r,16)
    }

    function n(e,n){
      for(var o="",c=r(e,n),a=n+2;a<e.length;a+=2){
        var l=r(e,a)^c;
        o+=String.fromCharCode(l)
      }
      return t(o)
    }

    var o="/cdn-cgi/l/email-protection#",
        c=".__cf_email__",
        a="data-cfemail",
        l=document.createElement("div");

    !function(){
      for(var t=document.getElementsByTagName("a"),r=0;r<t.length;r++)
        try{
          var c=t[r],a=c.href.indexOf(o);
          a>-1&&(c.href="mailto:"+n(c.href,a+o.length))
        }catch(t){
          e(t)
        }
    }(),
    function(){
      for(var t=document.querySelectorAll(c),r=0;r<t.length;r++)
        try{
          var o=t[r],l=n(o.getAttribute(a),0),i=document.createTextNode(l);
          o.parentNode.replaceChild(i,o)
        }catch(t){
          e(t)
        }
    }()
  });
</script>





<div hidden>
  
  <h2 class="sr-only">Templates (for web app):</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loading…</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Error</h1>
    
    
    <p class="lead">
      Sorry, an error occurred while loading <a class="this-link" href=""></a>.

    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

</div>


</body>
</html>
